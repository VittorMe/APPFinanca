<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="APPFinanca.Views.TransactionAdd"
             Title="Nova Transação">

    <ScrollView>
        <VerticalStackLayout Spacing="15" Padding="20">

            <!-- Header -->
            <Border
                Margin="0,0,0,10"
                Padding="20"
                BackgroundColor="Black"
                Stroke="Transparent"
                StrokeShape="RoundRectangle 30">

                <Grid ColumnDefinitions="*, 30" RowDefinitions="Auto">
                    <Label
                        Grid.Row="0"
                        Grid.Column="0"
                        HorizontalOptions="Center"
                        Text="Nova Transação"
                        TextColor="White"
                        FontSize="18"
                        FontAttributes="Bold"
                        VerticalOptions="Center" />
                    <Image 
                        Grid.Row="0"
                        Grid.Column="1"
                        HorizontalOptions="Center"
                        Source="close.svg"
                        WidthRequest="20"
                        HeightRequest="20">
                        <Image.GestureRecognizers>
                            <TapGestureRecognizer Tapped="TapGestureRecognizerTapped_ToClose" />
                        </Image.GestureRecognizers>
                    </Image>
                </Grid>
            </Border>

            <!-- Error Label -->
            <Label
                x:Name="LabelError"
                IsVisible="False"
                Style="{StaticResource ErrorLabelStyle}" />

            <!-- Transaction Type -->
            <Border Style="{StaticResource TransactionCardStyle}">
                <VerticalStackLayout Spacing="15">
                    <Label
                        Text="Tipo de Transação"
                        Style="{StaticResource TransactionHeaderStyle}" />
                    
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto">
                        <RadioButton
                            x:Name="RadioIncome"
                            Grid.Row="0"
                            Grid.Column="0"
                            Content=" Receita"
                            IsChecked="True" />
                        <RadioButton
                            x:Name="RadioExpense"
                            Grid.Row="0"
                            Grid.Column="1"
                            Content=" Despesa"
                            HorizontalOptions="End" />
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Basic Information -->
            <Border Style="{StaticResource TransactionCardStyle}">
                <VerticalStackLayout Spacing="15">
                    <Label
                        Text="Informações Básicas"
                        Style="{StaticResource TransactionHeaderStyle}" />
                    
                    <Entry
                        x:Name="EntryName"
                        Placeholder="Nome da transação" />

                    <Entry
                        x:Name="EntryLocation"
                        Placeholder="Local/Estabelecimento (opcional)" />

                    <Editor
                        x:Name="EditorDescription"
                        Placeholder="Descrição/Observações (opcional)"
                        AutoSize="TextChanges" />
                </VerticalStackLayout>
            </Border>

            <!-- Date and Payment -->
            <Border Style="{StaticResource TransactionCardStyle}">
                <VerticalStackLayout Spacing="15">
                    <Label
                        Text="Data e Pagamento"
                        Style="{StaticResource TransactionHeaderStyle}" />
                    
                    <DatePicker 
                        x:Name="DatePickerDate"
                        Format="dd/MM/yyyy" />

                    <Picker 
                        x:Name="pickerTipoPagamento"
                        Title="Tipo de Pagamento" />
                </VerticalStackLayout>
            </Border>

            <!-- Category and Value -->
            <Border Style="{StaticResource TransactionCardStyle}">
                <VerticalStackLayout Spacing="15">
                    <Label
                        Text="Categoria e Valor"
                        Style="{StaticResource TransactionHeaderStyle}" />
                    
                    <Picker 
                        x:Name="pickerTipoGrupo"
                        Title="Categoria" />

                    <Entry
                        x:Name="EntryValue"
                        Keyboard="Numeric"
                        Placeholder="R$ 0,00"
                        FontSize="18"
                        FontAttributes="Bold"
                        TextChanged="OnEntryValueTextChanged" />
                </VerticalStackLayout>
            </Border>

            <!-- Recurrence -->
            <Border Style="{StaticResource TransactionCardStyle}">
                <VerticalStackLayout Spacing="15">
                    <Label
                        Text="Recorrência"
                        Style="{StaticResource TransactionHeaderStyle}" />
                    
                    <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto">
                        <Label
                            Grid.Row="0"
                            Grid.Column="0"
                            Text="Transação Recorrente"
                            VerticalOptions="Center" />
                        <Switch
                            x:Name="SwitchRecurring"
                            Grid.Row="0"
                            Grid.Column="1"
                            IsToggled="False"
                            Toggled="OnSwitchRecurringToggled" />
                    </Grid>
                    
                    <Picker 
                        x:Name="PickerRecurrenceType"
                        Title="Tipo de Recorrência"
                        IsVisible="False" />
                </VerticalStackLayout>
            </Border>

            <!-- Save Button -->
            <Button
                Margin="0,20,0,0"
                Clicked="OnButtonClicked_Save"
                HorizontalOptions="Fill"
                Text="Salvar Transação"
                Style="{StaticResource PrimaryButtonStyle}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>